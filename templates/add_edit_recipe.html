{% extends "base_login.html" %}
{% block section %}
<section class="row no-gutters generic-background">
    <!-- Back Button -->
        <div class="col-12">
        <div class="row no-gutters justify-content-start">
            <div class="col-4 col-lg-2 custom-button sticky-note-no-shadow profile-button blank-anchor custom-js-button">
                {% if recipeId == "new"%}
                <a href="{{ url_for('profile') }}">
                    <div class="sticky-note-inner-div">
                        <h6>Back</h6>
                    </div>
                </a>
                {% else %}
                <a href="{{ url_for('recipe', recipeId=recipeId) }}">
                    <div class="sticky-note-inner-div">
                        <h6>Back</h6>
                    </div>
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-12">
        <div class="row no-gutters justify-content-center">
            {% if recipeId == "new" %} <!--  if session.editRecipe  --> <!-- I dont require apostrophe thats not right!! new is a string not variable -->
            <!--  For creating a new recipe  -->
            <form class="col-10 form-base generic-box-shadow yanone-text" method="POST" enctype="multipart/form-data" action="{{ url_for('add_edit_recipe', recipeId='new') }} ">
            {% else %}
            <!--  For editing a existing recipe  -->  
            <form class="col-10 form-base generic-box-shadow yanone-text" method="POST" enctype="multipart/form-data" action="{{ url_for('add_edit_recipe', recipeId=recipeInfo._id) }}">
            {% endif %}
                <div class="row no-gutters">

                    <!-- Section Description Header -->
                    <div class="col-12">
                        {% if recipeInfo == none %}
                        <!--  For creating a new recipe  -->
                        <h1>Add New Recipe</h1>
                        {% else %}
                        <!--  For editing a existing recipe  -->
                        <h1>{{ recipeInfo.name }}</h1>
                        {% endif %}
                    </div>
                    <hr>

                    <!-- Recipe Header - name and times -->
                    <div class="col-12">
                        <div class="row no-gutters justify-content-center form-input-spacing">
                            <!--  Recipe Name  -->
                            <div class="col-12">
                                <label type="text" for="name">Recipe Name</label>
                            </div>
                            <div class="col-12">
                                {% if recipeInfo == none %}
                                <!--  For creating a new recipe  -->
                                <input class="form-center-text" type="text" id="name" name="name" value="Recipe Name">
                                {% else %}
                                <!--  For editing a existing recipe  -->
                                <input class="form-center-text" type="text" id="name" name="name" value="{{ recipeInfo.name }}">
                                {% endif %}
                            </div>
                        </div>

                        <div class="row no-gutters justify-content-center">
                            <!--  Prep Time  -->
                            <span class="col-12 col-md-3 form-input-spacing">
                                <div class="row no-gutters">
                                    <div class="col-12 ">
                                        <label type="text" for="prepTime">Prep Time</label>
                                    </div>
                                    <div class="col-12">
                                        {% if recipeInfo == none %}
                                        <!--  For creating a new recipe  -->
                                        <input class="time form-center-text" type="number" id="time1" name="time1" value="15">
                                        {% else %}
                                        <!--  For editing a existing recipe  -->
                                        <input class="time form-center-text" type="number" id="time1" name="time1" value="{{ recipeInfo.time[0] }}">
                                        {% endif %}
                                        <p class="remove-p-margin">Minutes</p>
                                    </div>
                                </div>
                            </span>
                        
                            <!--  Cook Time  -->
                            <span class="col-12 col-md-3 form-input-spacing">
                                <div class="row no-gutters">
                                    <div class="col-12">
                                        <label type="text" for="cookTime">Cook Time</label>
                                    </div>
                                    <div class="col-12">
                                        <!-- Rewrite flask in value into repeating inputs -->
                                        {% if recipeInfo == none %}
                                        <!--  For creating a new recipe  -->
                                        <input class="time form-center-text" type="number" id="time2" name="time2" value="10">
                                        {% else %}
                                        <!--  For editing a existing recipe  -->
                                        <input class="time form-center-text" type="number" id="time2" name="time2" value="{{ recipeInfo.time[1] }}">
                                        {% endif %}
                                        <p class="remove-p-margin">Minutes</p>
                                    </div>    
                                </div>
                            </span>

                            <!--  Total Time  -->
                            <span class="col-12 col-md-3 form-input-spacing">
                                <div class="row no-gutters">
                                    <div class="col-12">
                                        <label type="text" for="totalTime">Total Time</label>
                                    </div>
                                    <div class="col-12">
                                        <!-- Rewrite flask in value into repeating inputs -->
                                        {% if recipeInfo == none %}
                                        <!--  For creating a new recipe  -->
                                        <input type="number" id="time3" name="time3" value="25" disabled>
                                        {% else %}
                                        <!--  For editing a existing recipe  -->
                                        <input type="number" id="time3" name="time3" value="{{ recipeInfo.time[2] }}" disabled>
                                        {% endif %}
                                        <p class="remove-p-margin">Minutes</p>
                                    </div>
                                </div>
                            </span>
                        </div>
                    </div>

                    <!-- Recipe Feature -->
                    <div class="col-12 col-md-6 form-input-spacing">
                        <div class="row no-gutters justify-content-center">
                            <div class="col-12">
                                <label type="text" for="feature">Featured Ingredient</label>
                            </div>
                            <div class="col-12 select-option-size">
                                <!-- Recipe feature select/option -->
                                <select name="feature" id="feature">
                                    <!-- Adds selected attribute -->
                                    {% for feature in features %}
                                        {% if recipeInfo == none and feature.name == 'chicken' %}
                                        <!--  For creating a new recipe  -->
                                        <option value="{{feature.name}}" selected>{{ feature.name.title() }}</option>
                                        {% elif feature.name == recipeInfo.feature %}
                                        <!--  For editing a existing recipe  -->
                                        <option value="{{feature.name}}" selected>{{ feature.name.title() }}</option>
                                        {% else %}
                                        <!--  For all none selected catagories  -->
                                        <option value="{{feature.name}}">{{ feature.name.title() }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Recipe Image -->
                    <div class="col-12 col-md-6 form-input-spacing">
                        <div class="row no-gutters">
                            <div class="col-12">
                                <label type="text" for="avatar">Recipe Image</label>
                            </div>
                            <div class="col-12">
                                <input type="file" name="avatar" id="avatar" class="avatar-upload">
                                <input type="text" name="avatar_name" id="avatar_name" class="make-invis" value="">
                                <input type="text" name="avatar_file_valid" id="avatar_file_valid" class="make-invis" value="">
                                <p id="avatar_valid" class="make-invis">Please select a file of 500KB or less. Server space is limited!</p>
                            </div>
                        </div>
                    </div>

                    {% if admin == True %}
                    <!--  FR Lazy Favorite and Grandparent Classic checkboxes -->
                    <div class="col-12 form-input-spacing">
                        <div class="row no-gutters">
                            <div class="col-12">
                                <legend type="text" for="avatar">FR Lazy Favorite or Grandparent Classic</legend>
                            </div>
                            <div class="col-12 checkboxes">
                                <div class="row no-gutters">

                                    <div class="col-12 col-md-6">
                                        <div class="row no-gutters">
                                            <!-- Sets checkbox for lazy -->
                                            <label class="col-12" for="lazy">Lazy favorite</label>
                                            <div class="col-12">
                                                <div class="row no-gutters justify-content-center">
                                                    {% if recipeInfo.lazy == True %}
                                                    <input type="checkbox" name="lazy" id="lazy" value="True" checked>
                                                    {% else %}
                                                    <input type="checkbox" name="lazy" id="lazy" value="True">
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                   <div class="col-12 col-md-6">
                                       <div class="row no-gutters">
                                           <!-- Sets checkboxe for grandparent -->
                                           <label class="col-12" for="grandparent">Grandparent Classic</label>
                                           <div class="col-12">
                                               <div class="row no-gutters justify-content-center">
                                                {% if recipeInfo.grandparent == True %}
                                                   <input type="checkbox" name="grandparent" id="grandparent" value="True" checked>
                                                   {% else %}
                                                   <input type="checkbox" name="grandparent" id="grandparent" value="True">
                                                   {% endif %}
                                                </div>
                                            </div>
                                       </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Recipe description -->
                    <div class="col-12 form-input-spacing">
                        <div class="row no-gutters justify-content-center" >
                            <div class="col-12">
                                <label type="text" for="text">Recipe Description</label>
                            </div>
                            <div class="col-12">
                                {% if recipeInfo == none %}
                                <!--  For creating a new recipe  -->
                                    <textarea type="text" id="text" name="text" cols="20" rows="5">Recipe Description</textarea>
                                {% else %}
                                <!--  For editing a existing recipe  -->
                                    <textarea type="text" id="text" name="text" cols="20" rows="5">{{ recipeInfo.text }}</textarea>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Recipe ingredients -->
                    <div class="col-12 form-input-spacing">
                        <div class="row no-gutters justify-content-center">
                            <!-- Recipe ingredient header -->
                            <div class="col-12"> <!-- removed . recipe-form-label  because of padding right -- off centering text -->
                                <label type="text" for="recipeIngredients" id="ingredientNumber">Recipe Ingredients (<span>1</span>)</label>  <!-- for id and name will have problems with JS additional script -->
                            </div>

                            <div class="col-12">
                                <div class="row no-gutters justify-content-center">
                                    <!-- Add button -->
                                    <div class="col-4 col-md-2">
                                        <div class="row no-gutters">
                                            <div class="col-12 custom-button recipeAddButton">
                                                <p>add</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Remove button -->
                                    <div class="col-4 col-md-2">
                                        <div class="row no-gutters">
                                            <div class="col-12 custom-button recipeRemoveButton">
                                                <p>Remove</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-10">
                                <div class="row no-gutters justify-content-center ingredientAddRemoveLocation">
                                    <!-- Creation and remove location for ingredient boxes -->
                                    {% if recipeInfo == none %}
                                    <input class="make-invis" type="text" name="recipeIngredientsTotal" id="recipeIngredientsTotal" value="1">
                                    <div class="col-12 col-md-6">
                                        <div class="row no-gutters align-items-center step-ingredient-spacing">
                                            <span class="col-1">
                                                <p>1. </p>
                                            </span>
                                            <input class="col-11 countIngredients" type="text" id="recipeIngredients-1" name="recipeIngredients-1">
                                        </div>
                                    </div>
                                    {% else %}
                                        <input class="make-invis" type="text" name="recipeIngredientsTotal" id="recipeIngredientsTotal" value="{{ recipeIngEnum[-1][0] + 1 }}">
                                        {% for ingredient in recipeIngEnum %}
                                            <div class="col-12 col-md-6">
                                                <div class="row no-gutters align-items-center step-ingredient-spacing">
                                                    <span class="col-1">
                                                        <p>{{ingredient[0] + 1}}. </p>
                                                    </span>
                                                    <input class="col-11 countIngredients" type="text" id="recipeIngredients-{{ingredient[0] + 1}}" name="recipeIngredients-{{ingredient[0] + 1}}" value="{{ingredient[1]}}">
                                                </div>
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recipe steps -->
                    <div class="col-12 form-input-spacing">
                        <div class="row no-gutters justify-content-center">
                            <!-- Recipe step header -->
                            <div class="col-12">
                                <label type="text" for="recipeSteps" id="stepNumber">Recipe Steps (<span>1</span>)</label>  <!-- for id and name will have problems with JS additional script -->
                            </div>

                            <div class="col-12">
                                <div class="row no-gutters justify-content-center">
                                    <!-- Add Button -->
                                    <div class="col-4 col-md-2">
                                        <div class="row no-gutters justify-content-end">
                                            <div class="col-12 custom-button stepAddButton">
                                                <p>add</p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Remove button -->
                                    <div class="col-4 col-md-2">
                                        <div class="row no-gutters">
                                            <div class="col-12 custom-button stepRemoveButton">
                                                <p>remove</p>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="col-10">
                                <div class="row no-gutters justify-content-center stepAddRemoveLocation">
                                    <!-- Creation and remove location for step boxes -->
                                    {% if recipeInfo == none %}
                                    <input class="make-invis" type="text" name="recipeStepsTotal" id="recipeStepsTotal" value="1">
                                    <div class="col-12 col-md-6">
                                        <div class="row no-gutters align-items-center step-ingredient-spacing">
                                            <span class="col-1">
                                                <p>1. </p>
                                            </span>
                                            <textarea class="col-11 countSteps" type="text" id="recipeSteps-1" name="recipeSteps-1" cols="20" rows="3"></textarea>
                                            <!-- I count for DB upload!! -->
                                        </div>
                                    </div>
                                    {% else %}
                                        <input class="make-invis" type="text" name="recipeStepsTotal" id="recipeStepsTotal" value="{{ recipeSteEnum[-1][0] + 1}}">
                                        {% for step in recipeSteEnum %}
                                            <div class="col-12 col-md-6">
                                                <div class="row no-gutters align-items-center step-ingredient-spacing">
                                                    <span class="col-1">
                                                        <p>{{step[0] + 1}}. </p>
                                                    </span>
                                                    <textarea class="col-11 countSteps" type="text" id="recipeSteps-{{step[0] + 1}}" name="recipeSteps-{{step[0] + 1}}" value="" col="20" rows="3">{{step[1]}}</textarea>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- submit button -->
                    <div class="col">
                        <input class="custom-button" id="custom-button" type="submit" value="Submit">
                    </div>

                </div>
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block custom_script %}
<script src="{{ url_for('static', filename='js/addEditRecipe.js') }}"></script>
<script src="{{ url_for('static', filename='js/avatarValidation.js') }}"></script>
<script src="{{ url_for('static', filename='js/button.js') }}"></script>
{% endblock %}